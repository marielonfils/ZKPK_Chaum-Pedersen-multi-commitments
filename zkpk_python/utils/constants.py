import numpy as np
from gmpy2 import mpz

###Group parameters and Generators loading###

#Group parameters and some generators
p = mpz(1044388881413152506691752710716624382579964249047383780384233483283953907971553643537729993126875883902173634017777416360502926082946377942955704498542097614841825246773580689398386320439747911160897731551074903967243883427132918813748016269754522343505285898816777211761912392772914485521155521641049273446207578961939840619466145806859275053476560973295158703823395710210329314709715239251736552384080845836048778667318931418338422443891025911884723433084701207771901944593286624979917391350564662632723703007964229849154756196890615252286533089643184902706926081744149289517418249153634178342075381874131646013444796894582106870531535803666254579602632453103741452569793905551901541856173251385047414840392753585581909950158046256810542678368121278509960520957624737942914600310646609792665012858397381435755902851312071248102599442308951327039250818892493767423329663783709190716162023529669217300939783171415808233146823000766917789286154006042281423733706462905243774854543127239500245873582012663666430583862778167369547603016344242729592244544608279405999759391099769165589722584216017468464576217318557948461765770700913220460557598574717173408252913596242281190298966500668625620138188265530628036538314433100326660047110143)
q = mpz(115792089237316195423570985008687907853269984665640564039457584007913129639747)  # pow(2, 256) - 189
r = mpz(9019518416950528558373478086511232658951474842525520401496114928154304263969655687927867442562559311457926593510757267649063628681241064260953609180947464800958467390949485096429653122916928704841547265126247408167856620024815508684472819746384115369148322548696439327979752948311712506113890045287907335656308945630141969472484100558565879585476547782717283106837945923693806973017510492730838409381014701258202694245760602718602550739205297257940969992371799325870179746191672464736721424617639973324090288952006260483222894269928179970153634220390287255837625331668555933039199194619824375869291271098935000699785346405055160394688637074599519052655517388596327473273906029869030988064607361165803129718773877185415445291671089029845994683414682274353665003204293107284473196033588697845087556526514092678744031772226855409523354476737660407619436531080189837076164818131039104397776628128325247709678431023369197272126578394856752060591013812807437681624251867074769638052097737959472027002770963255207757153746376691827309573603635608169799503216990026029763868313819255248026666854405409059422844776556067163611304891154793770115766608153679099327786) # (p - 1) / q
g = mpz(119359756198641231858139651428439585561105914902686985078252796680474637856752833978884422594516170665312423393830118608408063594508087813277769835084746883589963798527237870817233369094387978405585759195339509768803496494994109693743279157584139079471178850751266233150727771094796709619646350222242437970473900636242584673413224137139139346254912172628651028694427789523683070264102332413084663100402635889283790741342401259356660761075766365672754329863241692760862540151023800163269173550320623249398630247531924855997863109776955214403044727497968354022277828136634059011708099779241302941071701051050378539485717425482151777277387633806111112178267035315726401285294598397677116389893642725498831127977915200359151833767358091365292230363248410124916825814514852703770457024102738694375502049388804979035628232209959549199366986471874840784466132903083308458356458177839111623113116525230200791649979270165318729763550486200224695556789081331596212761936863634467236301450039399776963661755684863012396788149479256016157814129329192490798309248914535389650594573156725696657302152874510063002532052622638033113978672254680147128450265983503193865576932419282003012093526302631221491418211528781074474515924597472841036553107847)  # 2^r mod p
h = mpz(912458847585004706615236767867394961049094680925412377401924775487380923319934926255935724806174678853194249896543922913829401256644902172696061288511068582608242608166827520134811738040696906069158914903892127059897579208162800442802970339423843086613886250868259521958424805814045962719788666486486000922541885817913533255604697715789298729442708610240399894805268843261929494246367582557351009546691728464159044553898408527847508758313876447024431399780117426788950515637197136388583570576868627036477608809216858743286544856584469241261414571018494864160200197339720050175694321681520984609353043186541722321463234612491843634817593646544618672363141339646863232086375892625097701515757747943356044127661479420416472082928624489578535637163061077074313556134790949900490319602801833974259184883792282314803856992103866501043005292008037585678439065472663327648571496798449611219908536158838002043806523880578653302934010462326190724054208421881869503770582436272976221118624781208537798970965225289652297303301760666794884161774698935139526443174545848552727388793605582360016994737252472867055489396674092452670953825747124500326874337804569070174884020027032150086557953362264415596305643483378297562777340669555148781493785576)
u = mpz(448173647239253893004681337285693707517141135747204102508850675886294729430761530524869107309867472889393039011058160954835056055504509325193905639996083374473666915146992884172620225152430479640712754255302519871084820088802428811684616055793010902037042248792971421710226661765201618782079910039445588726074648945520049422163377709670661905576863519210074492574828714082901869215855198171242306897141368366896050603898104128429395623406000859615500493592902626483503330833246200148732027731820455696626090579210076165854088275354228435724901054817733400711046445186391445476019791390043094230427651303926532486685052769214896981789413754075195143395306984712781192612015901818135191980480537096987434746910312021128851231618965882056096486683761075339058806832262037251687384766132417985485156454377968999747004520386865720196890541225223187679063952932046057267843125815255707347123323623826647870088838579775072016258974821779301300152745908429681260221283677193466937595025468773880221245292436517897310534242014602105747011521296937705487898877096333874982557922163743815186823926895540472444730485950587586526453621310469097644901913122138424064491606239415566842729639491182858083462023019824396222156850665261281378264818649)

#Loading of the required number of generators
def generate_constants(l,m=None,n=None):
    """
    inputs
        - l : int
        - m : optional int, used in Logarithmic 0-1 and K-selection proofs
        - n : optional int, used in K-selection proof
    outputs
        - gs : array of mpz of size l containing generators (for Logarithmic 0-1, K-selection and Partial Opening)
        - hs : optional array of mpz of size l containing generators (for Logarithmic 0-1 and K-selection)
        - g_bolds : optional array of mpz of size lxm (Logarithmic 0-1) or nxm (K-selection) containing generators 
        - h_bolds : optional array of mpz of size lxm (Logarithmic 0-1) or nxm (K-selection) containing generators
    """	

    npzfile = np.load('./utils/constants.npz',allow_pickle=True)
    gs=npzfile['arr_1']
    if m is None and n is None:
        if l<=128:
            to_return = gs[:l]
            del gs
            return np.array(to_return,dtype=object)
        hs=npzfile['arr_0']    
        g_bolds=npzfile['arr_2']
        h_bolds=npzfile['arr_3']
        generators = np.concatenate((gs,hs),dtype=object)
        generators = np.concatenate((generators,g_bolds),dtype=object)
        generators = np.concatenate((generators,h_bolds),dtype=object)
        del gs
        del hs
        del g_bolds
        del h_bolds
        return np.array(generators[:l],dtype=object)

    if m is not None:
        s_2=l*m
        s=(l,m)
    if n is not None:
        s_2=n*m
        s=(n,m)
    
    
    hs=npzfile['arr_0']    
    g_bolds=npzfile['arr_2']
    h_bolds=npzfile['arr_3']
    hs_bis= np.array(hs[:l],dtype=object)
    gs_bis= np.array(gs[:l],dtype=object)
    g_bolds_bis = np.array(g_bolds[:s_2],dtype=object).reshape(s)
    h_bolds_bis = np.array(h_bolds[:s_2],dtype=object).reshape(s)
    del g_bolds
    del h_bolds
    del gs
    del hs
    return gs_bis,hs_bis,g_bolds_bis,h_bolds_bis



